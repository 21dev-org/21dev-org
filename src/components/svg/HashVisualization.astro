---
interface Props {
  class?: string;
}

const { class: className = '' } = Astro.props;
---

<svg
  class={className}
  viewBox="0 0 200 60"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
  aria-label="Hash Function"
>
  <defs>
    <linearGradient id="hash-input" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3B82F6"></stop>
      <stop offset="100%" style="stop-color:#2563EB"></stop>
    </linearGradient>
    <linearGradient id="hash-func" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#F7931A"></stop>
      <stop offset="100%" style="stop-color:#EA580C"></stop>
    </linearGradient>
    <linearGradient id="hash-output" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#22C55E"></stop>
      <stop offset="100%" style="stop-color:#16A34A"></stop>
    </linearGradient>
    <filter id="hash-shadow">
      <feDropShadow dx="0" dy="1" stdDeviation="1" flood-opacity="0.2"></feDropShadow>
    </filter>
  </defs>

  <!-- Input data -->
  <g class="input-group" filter="url(#hash-shadow)">
    <rect x="5" y="15" width="50" height="30" rx="3" fill="url(#hash-input)"></rect>
    <text x="30" y="28" text-anchor="middle" fill="white" font-size="5" opacity="0.8">任意資料</text
    >
    <text x="30" y="38" text-anchor="middle" fill="white" font-size="6" font-family="monospace"
      >"Hello"</text
    >
  </g>

  <!-- Arrow 1 -->
  <g class="arrow-1">
    <line x1="58" y1="30" x2="72" y2="30" stroke="#78716C" stroke-width="1.5"></line>
    <polygon points="72,27 78,30 72,33" fill="#78716C"></polygon>
  </g>

  <!-- Hash function box -->
  <g class="hash-func" filter="url(#hash-shadow)">
    <rect x="80" y="10" width="40" height="40" rx="4" fill="url(#hash-func)"></rect>
    <text x="100" y="28" text-anchor="middle" fill="white" font-size="6" font-weight="bold"
      >SHA</text
    >
    <text x="100" y="38" text-anchor="middle" fill="white" font-size="6" font-weight="bold"
      >256</text
    >
    <!-- Gear icon hint -->
    <circle
      cx="100"
      cy="33"
      r="8"
      stroke="white"
      stroke-width="1"
      stroke-opacity="0.3"
      fill="none"
      stroke-dasharray="2 2"
      class="gear"></circle>
  </g>

  <!-- Arrow 2 -->
  <g class="arrow-2">
    <line x1="122" y1="30" x2="138" y2="30" stroke="#78716C" stroke-width="1.5"></line>
    <polygon points="138,27 144,30 138,33" fill="#78716C"></polygon>
  </g>

  <!-- Output hash -->
  <g class="output-group" filter="url(#hash-shadow)">
    <rect x="145" y="15" width="50" height="30" rx="3" fill="url(#hash-output)"></rect>
    <text x="170" y="28" text-anchor="middle" fill="white" font-size="5" opacity="0.8"
      >固定長度</text
    >
    <text x="170" y="38" text-anchor="middle" fill="white" font-size="5" font-family="monospace"
      >2cf24d...</text
    >
  </g>

  <!-- Labels -->
  <g fill="currentColor" font-size="5" opacity="0.6">
    <text x="30" y="55" text-anchor="middle">輸入</text>
    <text x="100" y="58" text-anchor="middle">雜湊函數</text>
    <text x="170" y="55" text-anchor="middle">輸出 (256 bits)</text>
  </g>
</svg>

<style>
  .input-group,
  .hash-func,
  .output-group {
    animation: hash-appear 0.4s ease-out backwards;
  }

  .input-group {
    animation-delay: 0s;
  }
  .arrow-1 {
    animation: arrow-appear 0.3s ease-out backwards;
    animation-delay: 0.2s;
  }
  .hash-func {
    animation-delay: 0.3s;
  }
  .arrow-2 {
    animation: arrow-appear 0.3s ease-out backwards;
    animation-delay: 0.5s;
  }
  .output-group {
    animation-delay: 0.6s;
  }

  .gear {
    animation: gear-rotate 4s linear infinite;
    transform-origin: 100px 33px;
  }

  @keyframes hash-appear {
    from {
      opacity: 0;
      transform: scale(0.9);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes arrow-appear {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes gear-rotate {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
</style>
