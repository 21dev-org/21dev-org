---
interface Props {
  class?: string;
}

const { class: className = '' } = Astro.props;
---

<svg
  class={className}
  viewBox="0 0 200 120"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
  aria-label="Merkle Tree"
>
  <defs>
    <linearGradient id="merkle-root" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#F7931A"></stop>
      <stop offset="100%" style="stop-color:#EA580C"></stop>
    </linearGradient>
    <linearGradient id="merkle-branch" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#FB923C"></stop>
      <stop offset="100%" style="stop-color:#F97316"></stop>
    </linearGradient>
    <linearGradient id="merkle-leaf" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#FDBA74"></stop>
      <stop offset="100%" style="stop-color:#FB923C"></stop>
    </linearGradient>
    <filter id="merkle-glow">
      <feDropShadow dx="0" dy="1" stdDeviation="2" flood-color="#F7931A" flood-opacity="0.4"
      ></feDropShadow>
    </filter>
  </defs>

  <!-- Connecting lines -->
  <g stroke="#F7931A" stroke-width="1.5" stroke-opacity="0.4">
    <!-- Root to branches -->
    <line x1="100" y1="22" x2="60" y2="45" class="tree-line line-1"></line>
    <line x1="100" y1="22" x2="140" y2="45" class="tree-line line-2"></line>

    <!-- Branches to leaves -->
    <line x1="60" y1="57" x2="35" y2="80" class="tree-line line-3"></line>
    <line x1="60" y1="57" x2="85" y2="80" class="tree-line line-4"></line>
    <line x1="140" y1="57" x2="115" y2="80" class="tree-line line-5"></line>
    <line x1="140" y1="57" x2="165" y2="80" class="tree-line line-6"></line>
  </g>

  <!-- Root node -->
  <g class="node root-node" filter="url(#merkle-glow)">
    <rect x="80" y="8" width="40" height="14" rx="3" fill="url(#merkle-root)"></rect>
    <text x="100" y="18" text-anchor="middle" fill="white" font-size="7" font-weight="bold"
      >Root</text
    >
  </g>

  <!-- Branch nodes (level 1) -->
  <g class="node branch-node-1">
    <rect x="40" y="45" width="40" height="12" rx="2" fill="url(#merkle-branch)"></rect>
    <text x="60" y="54" text-anchor="middle" fill="white" font-size="6">H(AB)</text>
  </g>
  <g class="node branch-node-2">
    <rect x="120" y="45" width="40" height="12" rx="2" fill="url(#merkle-branch)"></rect>
    <text x="140" y="54" text-anchor="middle" fill="white" font-size="6">H(CD)</text>
  </g>

  <!-- Leaf nodes (level 2) -->
  <g class="node leaf-node-1">
    <rect x="20" y="80" width="30" height="10" rx="2" fill="url(#merkle-leaf)"></rect>
    <text x="35" y="88" text-anchor="middle" fill="white" font-size="5">H(A)</text>
  </g>
  <g class="node leaf-node-2">
    <rect x="70" y="80" width="30" height="10" rx="2" fill="url(#merkle-leaf)"></rect>
    <text x="85" y="88" text-anchor="middle" fill="white" font-size="5">H(B)</text>
  </g>
  <g class="node leaf-node-3">
    <rect x="100" y="80" width="30" height="10" rx="2" fill="url(#merkle-leaf)"></rect>
    <text x="115" y="88" text-anchor="middle" fill="white" font-size="5">H(C)</text>
  </g>
  <g class="node leaf-node-4">
    <rect x="150" y="80" width="30" height="10" rx="2" fill="url(#merkle-leaf)"></rect>
    <text x="165" y="88" text-anchor="middle" fill="white" font-size="5">H(D)</text>
  </g>

  <!-- Transaction labels -->
  <g fill="currentColor" font-size="6" opacity="0.6">
    <text x="35" y="100" text-anchor="middle">Tx A</text>
    <text x="85" y="100" text-anchor="middle">Tx B</text>
    <text x="115" y="100" text-anchor="middle">Tx C</text>
    <text x="165" y="100" text-anchor="middle">Tx D</text>
  </g>
</svg>

<style>
  .node {
    animation: node-appear 0.4s ease-out backwards;
  }

  .root-node {
    animation-delay: 0s;
  }
  .branch-node-1 {
    animation-delay: 0.2s;
  }
  .branch-node-2 {
    animation-delay: 0.3s;
  }
  .leaf-node-1 {
    animation-delay: 0.4s;
  }
  .leaf-node-2 {
    animation-delay: 0.5s;
  }
  .leaf-node-3 {
    animation-delay: 0.6s;
  }
  .leaf-node-4 {
    animation-delay: 0.7s;
  }

  .tree-line {
    animation: line-draw 0.3s ease-out backwards;
  }

  .line-1 {
    animation-delay: 0.1s;
  }
  .line-2 {
    animation-delay: 0.15s;
  }
  .line-3 {
    animation-delay: 0.25s;
  }
  .line-4 {
    animation-delay: 0.3s;
  }
  .line-5 {
    animation-delay: 0.35s;
  }
  .line-6 {
    animation-delay: 0.4s;
  }

  @keyframes node-appear {
    from {
      opacity: 0;
      transform: scale(0.8);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes line-draw {
    from {
      opacity: 0;
      stroke-dasharray: 50;
      stroke-dashoffset: 50;
    }
    to {
      opacity: 1;
      stroke-dasharray: 50;
      stroke-dashoffset: 0;
    }
  }
</style>
