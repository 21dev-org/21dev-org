---
/**
 * FAQ Section Component
 * Renders a list of frequently asked questions with expandable answers
 * Includes JSON-LD FAQPage schema for SEO
 */
import { generateFAQSchema } from '@/utils/schema';

interface FAQ {
  question: string;
  answer: string;
}

interface Props {
  title?: string;
  faqs: FAQ[];
  class?: string;
}

const { title = '常見問題', faqs, class: className = '' } = Astro.props;

const faqSchema = generateFAQSchema(faqs);
---

<section class:list={['faq-section', className]}>
  <h2 class="text-2xl font-bold text-[var(--text-primary)] mb-6">{title}</h2>

  <div class="space-y-3">
    {
      faqs.map((faq, index) => (
        <details class="faq-item group" data-faq-index={index}>
          <summary class="flex items-center justify-between gap-4 p-4 rounded-lg bg-[var(--bg-secondary)] cursor-pointer list-none hover:bg-[var(--bg-tertiary)] transition-colors">
            <span class="font-medium text-[var(--text-primary)]">{faq.question}</span>
            <svg
              class="w-5 h-5 text-[var(--text-tertiary)] transition-transform group-open:rotate-180 flex-shrink-0"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
            </svg>
          </summary>
          <div class="faq-answer px-4 pb-4 pt-2 text-[var(--text-secondary)] leading-relaxed">
            <Fragment set:html={faq.answer} />
          </div>
        </details>
      ))
    }
  </div>
</section>

<script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />

<style>
  .faq-item[open] summary {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
  }

  .faq-item[open] .faq-answer {
    background: var(--bg-secondary);
    border-bottom-left-radius: 0.5rem;
    border-bottom-right-radius: 0.5rem;
  }

  /* Remove default marker */
  .faq-item summary::-webkit-details-marker {
    display: none;
  }

  .faq-item summary::marker {
    display: none;
  }
</style>
