---
import PageLayout from '@/layouts/PageLayout.astro';
import Button from '@/components/ui/Button.astro';
import Card from '@/components/ui/Card.astro';
import LightningBolt from '@/components/svg/LightningBolt.astro';
---

<PageLayout
  title="Lightning Network"
  description="比特幣的 Layer 2 擴展方案，實現即時、低成本的支付。"
>
  <!-- Hero section -->
  <section class="py-16 md:py-24 bg-gradient-to-b from-[var(--bg-secondary)] to-[var(--bg-primary)] relative overflow-hidden">
    <div class="absolute inset-0 opacity-5">
      <div class="absolute top-1/4 right-1/4 w-96 h-96 bg-yellow-500 rounded-full blur-3xl"></div>
    </div>
    <div class="container-wide relative">
      <nav class="mb-8" aria-label="麵包屑">
        <ol class="flex items-center gap-2 text-sm text-[var(--text-tertiary)]">
          <li><a href="/" class="hover:text-[var(--text-primary)]">首頁</a></li>
          <li>/</li>
          <li><a href="/tech/" class="hover:text-[var(--text-primary)]">技術</a></li>
          <li>/</li>
          <li class="text-[var(--text-primary)]">Lightning Network</li>
        </ol>
      </nav>
      <div class="flex flex-col md:flex-row md:items-center gap-8">
        <div class="flex-1">
          <div class="flex items-center gap-4 mb-6">
            <LightningBolt size={48} />
            <span class="px-3 py-1 rounded-full text-sm font-medium bg-yellow-500/10 text-yellow-600 dark:text-yellow-400">
              Layer 2
            </span>
          </div>
          <h1 class="text-4xl md:text-5xl font-bold text-[var(--text-primary)] mb-6">
            Lightning Network
          </h1>
          <p class="text-xl text-[var(--text-secondary)] mb-8">
            閃電網路是建立在比特幣之上的 Layer 2 支付協議，
            通過支付通道實現即時、低成本的交易，同時保持比特幣的安全性。
          </p>
          <div class="flex flex-wrap gap-4">
            <Button href="https://lightning.network/" variant="primary" external>
              官方網站
            </Button>
            <Button href="/books/mastering-lightning" variant="secondary">
              精通閃電網路
            </Button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- How it works -->
  <section class="py-16 md:py-24">
    <div class="container-wide">
      <h2 class="text-3xl font-bold text-[var(--text-primary)] mb-12 text-center">
        運作原理
      </h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
        {[
          {
            step: '1',
            title: '開啟通道',
            description: '兩方在區塊鏈上創建一筆多簽交易，鎖定資金到支付通道。',
          },
          {
            step: '2',
            title: '鏈下交易',
            description: '雙方可以進行無數次即時交易，只需更新通道狀態，無需上鏈。',
          },
          {
            step: '3',
            title: '路由支付',
            description: '通過 HTLC 可以跨多個通道進行支付，無需直接連接。',
          },
          {
            step: '4',
            title: '關閉通道',
            description: '當不再需要通道時，將最終餘額結算到區塊鏈上。',
          },
        ].map((item) => (
          <Card padding="lg">
            <div class="w-10 h-10 rounded-full bg-yellow-500 text-white flex items-center justify-center font-bold mb-4">
              {item.step}
            </div>
            <h3 class="text-lg font-semibold text-[var(--text-primary)] mb-2">
              {item.title}
            </h3>
            <p class="text-[var(--text-secondary)] text-sm">
              {item.description}
            </p>
          </Card>
        ))}
      </div>
    </div>
  </section>

  <!-- Key concepts -->
  <section class="py-16 md:py-24 bg-[var(--bg-secondary)]">
    <div class="container-wide">
      <h2 class="text-3xl font-bold text-[var(--text-primary)] mb-12 text-center">
        關鍵概念
      </h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        {[
          {
            title: '支付通道',
            description: '雙向支付渠道，允許無限次即時交易。',
          },
          {
            title: 'HTLC',
            description: '哈希時間鎖定合約，跨通道原子交換。',
          },
          {
            title: '路由',
            description: '多跳路徑找到支付目的地。',
          },
          {
            title: 'BOLT 規範',
            description: '閃電網路的協議標準。',
          },
          {
            title: 'Invoice',
            description: '支付請求，包含金額和目的地。',
          },
          {
            title: '流動性',
            description: '通道中可用於支付的資金。',
          },
        ].map((concept) => (
          <Card padding="lg">
            <h3 class="text-xl font-semibold text-[var(--text-primary)] mb-2">
              {concept.title}
            </h3>
            <p class="text-[var(--text-secondary)]">
              {concept.description}
            </p>
          </Card>
        ))}
      </div>
    </div>
  </section>

  <!-- Implementations -->
  <section class="py-16 md:py-24">
    <div class="container-wide">
      <h2 class="text-3xl font-bold text-[var(--text-primary)] mb-12 text-center">
        主要實現
      </h2>
      <div class="grid md:grid-cols-3 gap-6 max-w-4xl mx-auto">
        {[
          {
            name: 'LND',
            org: 'Lightning Labs',
            lang: 'Go',
            url: 'https://github.com/lightningnetwork/lnd',
          },
          {
            name: 'Core Lightning',
            org: 'Blockstream',
            lang: 'C',
            url: 'https://github.com/ElementsProject/lightning',
          },
          {
            name: 'Eclair',
            org: 'ACINQ',
            lang: 'Scala',
            url: 'https://github.com/ACINQ/eclair',
          },
        ].map((impl) => (
          <a
            href={impl.url}
            target="_blank"
            rel="noopener noreferrer"
            class="block p-6 rounded-xl border border-[var(--border-default)] bg-[var(--surface-elevated)] hover:border-yellow-500 transition-colors"
          >
            <h3 class="text-xl font-semibold text-[var(--text-primary)] mb-2">{impl.name}</h3>
            <p class="text-sm text-[var(--text-secondary)] mb-3">{impl.org}</p>
            <span class="inline-block px-2 py-1 text-xs rounded bg-neutral-100 dark:bg-neutral-800 text-[var(--text-tertiary)]">
              {impl.lang}
            </span>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- Technical Documentation -->
  <section class="py-16 md:py-24">
    <div class="container-wide">
      <h2 class="text-3xl font-bold text-[var(--text-primary)] mb-4 text-center">
        技術文檔
      </h2>
      <p class="text-center text-[var(--text-secondary)] mb-12 max-w-2xl mx-auto">
        深入了解閃電網路的協議設計、BOLT 規範和網路運營。
      </p>

      <!-- Protocol Fundamentals -->
      <div class="mb-12">
        <h3 class="text-xl font-semibold text-[var(--text-primary)] mb-6 flex items-center gap-2">
          <span class="w-8 h-8 rounded-lg bg-yellow-500 text-white flex items-center justify-center text-sm font-bold">1</span>
          協議基礎
        </h3>
        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
          <Card href="/tech/lightning/payment-channels" padding="md">
            <h4 class="font-semibold text-[var(--text-primary)] mb-1">支付通道</h4>
            <p class="text-sm text-[var(--text-secondary)]">資金鎖定、狀態更新、關閉</p>
          </Card>
          <Card href="/tech/lightning/htlc" padding="md">
            <h4 class="font-semibold text-[var(--text-primary)] mb-1">HTLC 詳解</h4>
            <p class="text-sm text-[var(--text-secondary)]">哈希時間鎖、多跳支付</p>
          </Card>
          <Card href="/tech/lightning/commitment-tx" padding="md">
            <h4 class="font-semibold text-[var(--text-primary)] mb-1">承諾交易</h4>
            <p class="text-sm text-[var(--text-secondary)]">交易結構、撤銷機制</p>
          </Card>
          <Card href="/tech/lightning/channel-states" padding="md">
            <h4 class="font-semibold text-[var(--text-primary)] mb-1">通道狀態機</h4>
            <p class="text-sm text-[var(--text-secondary)]">生命週期、狀態轉換</p>
          </Card>
        </div>
      </div>

      <!-- BOLT Specifications -->
      <div class="mb-12">
        <h3 class="text-xl font-semibold text-[var(--text-primary)] mb-6 flex items-center gap-2">
          <span class="w-8 h-8 rounded-lg bg-blue-500 text-white flex items-center justify-center text-sm font-bold">2</span>
          BOLT 規範
        </h3>
        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
          <Card href="/tech/lightning/bolt-overview" padding="md">
            <h4 class="font-semibold text-[var(--text-primary)] mb-1">BOLT 規範概覽</h4>
            <p class="text-sm text-[var(--text-secondary)]">規範體系、功能位</p>
          </Card>
          <Card href="/tech/lightning/bolt-messages" padding="md">
            <h4 class="font-semibold text-[var(--text-primary)] mb-1">訊息協議</h4>
            <p class="text-sm text-[var(--text-secondary)]">P2P 訊息格式</p>
          </Card>
          <Card href="/tech/lightning/bolt-onion" padding="md">
            <h4 class="font-semibold text-[var(--text-primary)] mb-1">洋蔥路由</h4>
            <p class="text-sm text-[var(--text-secondary)]">隱私保護、加密</p>
          </Card>
          <Card href="/tech/lightning/bolt-invoice" padding="md">
            <h4 class="font-semibold text-[var(--text-primary)] mb-1">發票格式</h4>
            <p class="text-sm text-[var(--text-secondary)]">BOLT 11、Offers</p>
          </Card>
        </div>
      </div>

      <!-- Network Operations -->
      <div class="mb-12">
        <h3 class="text-xl font-semibold text-[var(--text-primary)] mb-6 flex items-center gap-2">
          <span class="w-8 h-8 rounded-lg bg-purple-500 text-white flex items-center justify-center text-sm font-bold">3</span>
          網路運營
        </h3>
        <div class="grid md:grid-cols-3 gap-4">
          <Card href="/tech/lightning/routing" padding="md">
            <h4 class="font-semibold text-[var(--text-primary)] mb-1">路由與尋路</h4>
            <p class="text-sm text-[var(--text-secondary)]">路徑搜索、MPP</p>
          </Card>
          <Card href="/tech/lightning/liquidity" padding="md">
            <h4 class="font-semibold text-[var(--text-primary)] mb-1">流動性管理</h4>
            <p class="text-sm text-[var(--text-secondary)]">入站/出站、再平衡</p>
          </Card>
          <Card href="/tech/lightning/channel-management" padding="md">
            <h4 class="font-semibold text-[var(--text-primary)] mb-1">通道管理</h4>
            <p class="text-sm text-[var(--text-secondary)]">開啟、監控、關閉</p>
          </Card>
        </div>
      </div>
    </div>
  </section>

  <!-- Resources -->
  <section class="py-16 md:py-24 bg-[var(--bg-secondary)]">
    <div class="container-wide">
      <h2 class="text-3xl font-bold text-[var(--text-primary)] mb-12 text-center">
        延伸資源
      </h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-5xl mx-auto">
        <Card href="/books/mastering-lightning" padding="md">
          <h3 class="font-semibold text-[var(--text-primary)] mb-1">精通閃電網路</h3>
          <p class="text-sm text-[var(--text-secondary)]">完整技術書籍</p>
        </Card>
        <Card href="/learn/lightning/" padding="md">
          <h3 class="font-semibold text-[var(--text-primary)] mb-1">閃電網路學習</h3>
          <p class="text-sm text-[var(--text-secondary)]">入門教程</p>
        </Card>
        <Card href="/tech/lightning/implementations" padding="md">
          <h3 class="font-semibold text-[var(--text-primary)] mb-1">實現比較</h3>
          <p class="text-sm text-[var(--text-secondary)]">LND、CLN、Eclair</p>
        </Card>
        <Card href="https://github.com/lightning/bolts" padding="md">
          <h3 class="font-semibold text-[var(--text-primary)] mb-1">BOLT 規範</h3>
          <p class="text-sm text-[var(--text-secondary)]">官方規範倉庫</p>
        </Card>
      </div>
    </div>
  </section>
</PageLayout>
