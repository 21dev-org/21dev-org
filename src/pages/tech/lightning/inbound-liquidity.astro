---
import ArticleLayout from '@/layouts/ArticleLayout.astro';
---

<ArticleLayout
  title="Inbound Liquidity 入站容量"
  description="了解閃電網路入站容量的概念，以及獲取入站容量的各種方法，使節點能夠接收支付。"
  breadcrumbs={[
    { label: '技術', href: '/tech/' },
    { label: 'Lightning Network', href: '/tech/lightning/' },
    { label: 'Inbound Liquidity' },
  ]}
  difficulty="intermediate"
  readingTime="10 分鐘"
  prevPage={{ title: 'Node Operation', href: '/tech/lightning/node-operation' }}
  nextPage={{ title: 'Wumbo Channels', href: '/tech/lightning/wumbo-channels' }}
>
  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">什麼是入站容量？</h2>
  <p class="text-[var(--text-secondary)] leading-relaxed mb-6">
    入站容量（Inbound Liquidity）是指其他節點可以向你發送支付的最大金額。
    這是閃電網路新用戶面臨的主要挑戰之一：當你開通道時，所有資金都在你這一側（出站容量），
    而你需要對方有資金在通道中才能接收支付。
  </p>

  <div class="not-prose mb-8 p-4 rounded-lg bg-blue-500/10 border border-blue-500/30">
    <p class="text-sm text-blue-700 dark:text-blue-400">
      <strong>核心概念：</strong>
      入站容量 = 對方在通道中的餘額。
      你的出站容量 = 你的入站容量對調。
    </p>
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">容量基礎</h2>

  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]">{`Channel Capacity Diagram

Your Node              Channel Capacity 1 BTC           Peer Node

  Your Balance <-------------------------> Peer Balance

  [=============================]..........
  0.8 BTC                                    0.2 BTC

  Outbound capacity: 0.8 BTC    Inbound capacity: 0.2 BTC

When opening new channel (you fund 1 BTC):

  [===============================================]..
  1.0 BTC                                    0 BTC

  Outbound capacity: ~1 BTC     Inbound capacity: 0
  -> Can send payments          -> Cannot receive payments`}</pre>
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">獲取入站容量的方法</h2>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">1. 讓其他人向你開通道</h3>

  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]">{`Passively Acquiring Inbound Capacity

When other nodes open channel to you:
Peer funds 0.5 BTC to open channel

  ..........................[==================]
  0 BTC                                    0.5 BTC

  Your inbound capacity: 0.5 BTC (can receive)
  Your outbound capacity: 0 BTC (need to receive first)

How to Attract Inbound Channels:
• Run a reliable node (high uptime)
• Set reasonable routing fees
• Connect to network hub nodes
• Announce node in forums/communities
• Provide valuable services (routing, liquidity)`}</pre>
  </div>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">2. 花費出站容量</h3>

  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]">{`Converting Capacity Through Payments

Initial state:
  [===============================================]..
  1.0 BTC                                    0 BTC

After you send 0.3 BTC payment:
  [================================]..............
  0.7 BTC                                    0.3 BTC

  Outbound capacity: 0.7 BTC     Inbound capacity: 0.3 BTC

Methods:
• Buy goods/services
• Bitrefill gift cards
• Loop Out to on-chain
• Pay to your other channels (circular payment)
• Purchase inbound capacity service`}</pre>
  </div>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">3. 購買入站容量</h3>

  <div class="grid md:grid-cols-2 gap-4 mb-8">
    <div class="p-4 rounded-lg border border-[var(--border-default)] bg-[var(--surface-elevated)]">
      <h4 class="font-semibold text-[var(--text-primary)] mb-2">Lightning Pool</h4>
      <p class="text-sm text-[var(--text-secondary)]">
        Lightning Labs 的流動性市場。通過拍賣機制購買入站容量，
        價格由市場決定。支援租賃期限選擇。
      </p>
    </div>
    <div class="p-4 rounded-lg border border-[var(--border-default)] bg-[var(--surface-elevated)]">
      <h4 class="font-semibold text-[var(--text-primary)] mb-2">Magma by Amboss</h4>
      <p class="text-sm text-[var(--text-secondary)]">
        P2P 流動性市場，可以直接購買特定節點的入站容量。
        支援多種定價模式。
      </p>
    </div>
    <div class="p-4 rounded-lg border border-[var(--border-default)] bg-[var(--surface-elevated)]">
      <h4 class="font-semibold text-[var(--text-primary)] mb-2">LNBIG</h4>
      <p class="text-sm text-[var(--text-secondary)]">
        大型流動性提供商，可以購買入站通道。
        提供不同容量等級選擇。
      </p>
    </div>
    <div class="p-4 rounded-lg border border-[var(--border-default)] bg-[var(--surface-elevated)]">
      <h4 class="font-semibold text-[var(--text-primary)] mb-2">Voltage Flow</h4>
      <p class="text-sm text-[var(--text-secondary)]">
        Voltage 的流動性服務，適合企業用戶。
        提供管理式流動性解決方案。
      </p>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">4. 雙向注資通道</h3>

  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]">{`Dual-Funded Channels

Both parties fund when opening channel:
You fund 0.5 BTC + Peer funds 0.5 BTC = 1 BTC channel

  [======================]........................
  0.5 BTC                                    0.5 BTC

  Outbound capacity: 0.5 BTC     Inbound capacity: 0.5 BTC

Advantages: Have bidirectional liquidity from the start
Requires: Both support option_dual_fund

Liquidity Ads:
Nodes can advertise liquidity they're willing to provide and pricing

Ad contents:
• Min/max amount
• Lease duration (in blocks)
• Rate (per sat per block)
• Base fee

CLN Support:
lightning-cli funderupdate ...`}</pre>
  </div>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">5. Submarine Swaps</h3>

  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]">{`Loop Out (Off-chain -> On-chain)

Convert Lightning balance to on-chain Bitcoin while gaining inbound capacity:

Initial state:
  You --(1 BTC)--> Loop Node
  Outbound capacity: 1 BTC

After Loop Out 0.5 BTC:
  You <--(0.5 BTC)-- Loop Node
  + 0.5 BTC on-chain (minus fees)

  Inbound capacity: 0.5 BTC

Service Providers:
• Loop by Lightning Labs
• Boltz Exchange
• Deezy
• Breez (integrated in wallet)`}</pre>
  </div>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">6. LSP 服務</h3>

  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]">{`Lightning Service Provider Provides Instant Inbound Capacity

JIT (Just-In-Time) Channels:
1. You receive a payment request
2. LSP intercepts payment
3. LSP instantly opens channel to you
4. Payment completes through new channel
5. LSP deducts channel opening fee from payment

User experience: No pre-setup needed, automatically get inbound capacity

Common LSPs:
• Phoenix (ACINQ)
• Breez
• Blixt
• Zeus (Olympus)
• Mutiny (Mutiny LSP)

Cost Considerations:
• JIT channel fees usually deducted from payment
• Zero-conf channels reduce waiting time
• Suitable for small users; large users save by self-managing`}</pre>
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">入站容量策略</h2>

  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]">{`Recommended Strategies for Different Scenarios

Individual Users (primarily receiving):
• Use LSP wallets (Phoenix, Breez)
• Let LSP auto-manage inbound capacity
• Costs deducted from received payments

Small Merchants:
• Purchase inbound capacity from large nodes
• Use Loop Out for periodic conversion
• Consider Lightning Pool rental
• Maintain multiple inbound channels for risk distribution

Routing Nodes:
• Prioritize dual-funded channels
• Use liquidity ads
• Actively balance channels
• Mutually open channels with other routing nodes
• Monitor and optimize inbound/outbound ratio

Large Merchants/Exchanges:
• Professional liquidity management
• Build own liquidity infrastructure
• Establish relationships with multiple large nodes
• Consider running multiple nodes`}</pre>
  </div>

  <div class="not-prose mb-8 p-4 rounded-lg bg-yellow-500/10 border border-yellow-500/30">
    <p class="text-sm text-yellow-700 dark:text-yellow-400">
      <strong>成本提示：</strong>
      入站容量不是免費的。無論是購買、租賃還是通過支出獲得，都有相應成本。
      選擇最適合你使用模式的方法。
    </p>
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">相關資源</h2>

  <ul class="space-y-2 text-[var(--text-secondary)] mb-6">
    <li>
      • <a
        href="https://lightning.engineering/pool/"
        class="text-yellow-600 dark:text-yellow-400 hover:underline">Lightning Pool</a>
    </li>
    <li>
      • <a
        href="/tech/lightning/lsp"
        class="text-yellow-600 dark:text-yellow-400 hover:underline">Lightning Service Provider</a>
    </li>
    <li>
      • <a
        href="/tech/lightning/submarine-swaps"
        class="text-yellow-600 dark:text-yellow-400 hover:underline">Submarine Swaps</a>
    </li>
    <li>
      • <a
        href="/tech/lightning/dual-funded"
        class="text-yellow-600 dark:text-yellow-400 hover:underline">Dual-Funded Channels</a>
    </li>
  </ul>

  <div class="mt-8 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)]">
    <p class="text-sm text-[var(--text-secondary)]">
      <strong class="text-[var(--text-primary)]">下一步：</strong>
      了解 <a
        href="/tech/lightning/wumbo-channels"
        class="text-yellow-600 dark:text-yellow-400 hover:underline">Wumbo 大額通道</a
      >
      如何突破通道容量限制。
    </p>
  </div>
</ArticleLayout>
