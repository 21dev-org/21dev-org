---
import ArticleLayout from '@/layouts/ArticleLayout.astro';
---

<ArticleLayout
  title="NIP-25 åæ‡‰"
  description="æ·±å…¥äº†è§£ Nostr çš„åæ‡‰ç³»çµ±ï¼ŒæŒ‰è®šã€è¡¨æƒ…ç¬¦è™Ÿåæ‡‰å’Œåæ‡‰çµ±è¨ˆã€‚"
  breadcrumbs={[
    { label: 'æŠ€è¡“', href: '/tech/' },
    { label: 'Nostr', href: '/tech/nostr/' },
    { label: 'NIP-25 åæ‡‰' },
  ]}
  difficulty="beginner"
  readingTime="8 åˆ†é˜"
  prevPage={{ title: 'NIP-23 é•·æ–‡å…§å®¹', href: '/tech/nostr/nip-23' }}
  nextPage={{ title: 'NIP-44 åŠ å¯†è¨Šæ¯ v2', href: '/tech/nostr/nip-44' }}
>
  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">ä»€éº¼æ˜¯ NIP-25ï¼Ÿ</h2>
  <p class="text-[var(--text-secondary)] leading-relaxed mb-6">
    NIP-25 å®šç¾©äº† Nostr ä¸­çš„åæ‡‰ï¼ˆReactionsï¼‰æ©Ÿåˆ¶ï¼Œè®“ç”¨æˆ¶å¯ä»¥å°äº‹ä»¶è¡¨é”
    å–œæ­¡ã€ä¸å–œæ­¡æˆ–ä½¿ç”¨è¡¨æƒ…ç¬¦è™Ÿåæ‡‰ã€‚åæ‡‰æ˜¯ kind 7 äº‹ä»¶ï¼Œé€éæ¨™ç±¤å¼•ç”¨ç›®æ¨™äº‹ä»¶ã€‚
  </p>

  <div class="not-prose mb-8 p-4 rounded-lg bg-purple-500/10 border border-purple-500/30">
    <p class="text-sm text-purple-700 dark:text-purple-400">
      <strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong>
      åæ‡‰ä½¿ç”¨ content æ¬„ä½è¡¨é”åæ‡‰é¡å‹ï¼š"+" è¡¨ç¤ºå–œæ­¡ï¼Œ"-" è¡¨ç¤ºä¸å–œæ­¡ï¼Œ æˆ–ä»»ä½•è¡¨æƒ…ç¬¦è™Ÿå¦‚ "ğŸ‘"ã€"â¤ï¸"ã€"ğŸ”¥"ã€‚
    </p>
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">äº‹ä»¶çµæ§‹</h2>

  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]"><code>{`{
  "kind": 7,
  "content": "+",                    // æˆ– "-" æˆ–è¡¨æƒ…ç¬¦è™Ÿ
  "tags": [
    ["e", "<event-id>", "<relay>"],  // è¢«åæ‡‰çš„äº‹ä»¶
    ["p", "<event-author-pubkey>"]   // äº‹ä»¶ä½œè€…
  ],
  "created_at": 1234567890,
  "pubkey": "<reactor-pubkey>",
  "id": "...",
  "sig": "..."
}`}</code></pre>
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">åæ‡‰é¡å‹</h2>

  <div class="not-prose mb-8">
    <table class="w-full text-sm">
      <thead>
        <tr class="border-b border-[var(--border-default)]">
          <th class="text-left py-3 px-4 font-semibold text-[var(--text-primary)]" scope="col"
            >Content</th
          >
          <th class="text-left py-3 px-4 font-semibold text-[var(--text-primary)]" scope="col"
            >å«ç¾©</th
          >
          <th class="text-left py-3 px-4 font-semibold text-[var(--text-primary)]" scope="col"
            >èªªæ˜</th
          >
        </tr>
      </thead>
      <tbody class="text-[var(--text-secondary)]">
        <tr class="border-b border-[var(--border-default)]">
          <td class="py-3 px-4 font-mono text-green-500 text-xl">+</td>
          <td class="py-3 px-4">å–œæ­¡ / æŒ‰è®š</td>
          <td class="py-3 px-4">æ­£é¢åæ‡‰ï¼Œé€šå¸¸é¡¯ç¤ºç‚ºæ„›å¿ƒæˆ–è®š</td>
        </tr>
        <tr class="border-b border-[var(--border-default)]">
          <td class="py-3 px-4 font-mono text-red-500 text-xl">-</td>
          <td class="py-3 px-4">ä¸å–œæ­¡</td>
          <td class="py-3 px-4">è² é¢åæ‡‰ï¼Œéƒ¨åˆ†å®¢æˆ¶ç«¯å¯èƒ½ä¸é¡¯ç¤º</td>
        </tr>
        <tr class="border-b border-[var(--border-default)]">
          <td class="py-3 px-4 text-xl">ğŸ‘ â¤ï¸ ğŸ”¥ ğŸ˜‚ ğŸ˜¢</td>
          <td class="py-3 px-4">è¡¨æƒ…åæ‡‰</td>
          <td class="py-3 px-4">ä»»ä½• Unicode è¡¨æƒ…ç¬¦è™Ÿ</td>
        </tr>
        <tr class="border-b border-[var(--border-default)]">
          <td class="py-3 px-4 font-mono text-purple-500">:custom:</td>
          <td class="py-3 px-4">è‡ªè¨‚è¡¨æƒ…</td>
          <td class="py-3 px-4">éœ€é…åˆ emoji æ¨™ç±¤ä½¿ç”¨</td>
        </tr>
      </tbody>
    </table>
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">ç¯„ä¾‹</h2>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">æŒ‰è®š</h3>
  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]"><code>{`{
  "kind": 7,
  "content": "+",
  "tags": [
    ["e", "abc123...", "wss://relay.damus.io"],
    ["p", "def456..."]
  ]
}`}</code></pre>
  </div>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">è¡¨æƒ…åæ‡‰</h3>
  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]"><code>{`{
  "kind": 7,
  "content": "ğŸ”¥",
  "tags": [
    ["e", "abc123...", "wss://relay.damus.io"],
    ["p", "def456..."]
  ]
}`}</code></pre>
  </div>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">è‡ªè¨‚è¡¨æƒ…</h3>
  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]"><code>{`{
  "kind": 7,
  "content": ":sats:",
  "tags": [
    ["e", "abc123..."],
    ["p", "def456..."],
    ["emoji", "sats", "https://example.com/sats.png"]
  ]
}

// emoji æ¨™ç±¤æ ¼å¼ï¼š["emoji", "shortcode", "image-url"]`}</code></pre>
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">ç¨‹å¼ç¢¼ç¯„ä¾‹</h2>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">ç™¼é€åæ‡‰</h3>
  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]"><code>{`async function sendReaction(targetEvent, reaction = '+') {
  const event = {
    kind: 7,
    created_at: Math.floor(Date.now() / 1000),
    content: reaction,
    tags: [
      ['e', targetEvent.id, 'wss://relay.damus.io'],
      ['p', targetEvent.pubkey]
    ]
  }

  // ç°½åä¸¦ç™¼é€
  const signedEvent = await window.nostr.signEvent(event)
  relay.send(JSON.stringify(['EVENT', signedEvent]))

  return signedEvent
}

// ä½¿ç”¨
await sendReaction(somePost, 'â¤ï¸')  // æ„›å¿ƒåæ‡‰
await sendReaction(somePost, '+')   // æŒ‰è®š
await sendReaction(somePost, 'ğŸš€')  // ç«ç®­åæ‡‰`}</code></pre>
  </div>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">æŸ¥è©¢åæ‡‰</h3>
  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]"><code>{`// æŸ¥è©¢ç‰¹å®šäº‹ä»¶çš„æ‰€æœ‰åæ‡‰
["REQ", "reactions", {
  "kinds": [7],
  "#e": ["<event-id>"]
}]

// æŸ¥è©¢æˆ‘æ”¶åˆ°çš„æ‰€æœ‰åæ‡‰
["REQ", "my-reactions", {
  "kinds": [7],
  "#p": ["<my-pubkey>"]
}]

// æŸ¥è©¢ç‰¹å®šç”¨æˆ¶ç™¼å‡ºçš„åæ‡‰
["REQ", "user-reactions", {
  "kinds": [7],
  "authors": ["<user-pubkey>"]
}]`}</code></pre>
  </div>

  <h3 class="text-xl font-semibold text-[var(--text-primary)] mt-6 mb-3">çµ±è¨ˆåæ‡‰</h3>
  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]"><code>{`function countReactions(reactions) {
  const counts = {
    likes: 0,      // + åæ‡‰
    dislikes: 0,   // - åæ‡‰
    emojis: {}     // å…¶ä»–è¡¨æƒ…
  }

  for (const r of reactions) {
    if (r.content === '+') {
      counts.likes++
    } else if (r.content === '-') {
      counts.dislikes++
    } else {
      counts.emojis[r.content] = (counts.emojis[r.content] || 0) + 1
    }
  }

  return counts
}

// çµæœç¯„ä¾‹
// {
//   likes: 42,
//   dislikes: 2,
//   emojis: { 'ğŸ”¥': 10, 'â¤ï¸': 8, 'ğŸ˜‚': 5 }
// }`}</code></pre>
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">åæ‡‰åˆ°å…¶ä»–äº‹ä»¶é¡å‹</h2>
  <p class="text-[var(--text-secondary)] leading-relaxed mb-4">
    NIP-25 å¯ä»¥å°ä»»ä½•äº‹ä»¶é¡å‹åæ‡‰ï¼Œä¸åªæ˜¯è²¼æ–‡ï¼š
  </p>

  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]"><code>{`// åæ‡‰åˆ°é•·æ–‡ (kind 30023)
{
  "kind": 7,
  "content": "ğŸ‘",
  "tags": [
    ["e", "<article-event-id>"],
    ["p", "<author-pubkey>"],
    ["a", "30023:<author>:<d-tag>", "wss://relay.com"]
  ]
}

// "a" æ¨™ç±¤ç”¨æ–¼å¯æ›¿æ›äº‹ä»¶ï¼Œç¢ºä¿åæ‡‰æŒ‡å‘æ­£ç¢ºçš„å…§å®¹`}</code></pre>
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">UI è¨­è¨ˆè€ƒé‡</h2>

  <div class="grid md:grid-cols-2 gap-4 mb-8">
    {
      [
        {
          title: 'åæ‡‰é¸æ“‡å™¨',
          desc: 'æä¾›å¿«é€ŸæŒ‰è®šæŒ‰éˆ•å’Œè¡¨æƒ…é¸æ“‡å™¨',
          example: 'ğŸ‘ â¤ï¸ ğŸ˜‚ ğŸ˜¢ ğŸ˜¡ ğŸ”¥',
        },
        {
          title: 'åæ‡‰è¨ˆæ•¸',
          desc: 'é¡¯ç¤ºæ¯ç¨®åæ‡‰çš„æ•¸é‡',
          example: 'â¤ï¸ 42  ğŸ”¥ 15  ğŸ˜‚ 8',
        },
        {
          title: 'åæ‡‰åˆ—è¡¨',
          desc: 'é»æ“Šå¯æŸ¥çœ‹èª°çµ¦äº†åæ‡‰',
          example: 'Alice, Bob å’Œå…¶ä»– 40 äºº',
        },
        {
          title: 'æˆ‘çš„åæ‡‰',
          desc: 'é«˜äº®é¡¯ç¤ºç”¨æˆ¶è‡ªå·±çš„åæ‡‰',
          example: 'å·²æŒ‰è®šï¼ˆé»æ“Šå–æ¶ˆï¼‰',
        },
      ].map((item) => (
        <div class="p-4 rounded-lg border border-[var(--border-default)] bg-[var(--surface-elevated)]">
          <h4 class="font-semibold text-[var(--text-primary)] mb-1">{item.title}</h4>
          <p class="text-sm text-[var(--text-secondary)] mb-2">{item.desc}</p>
          <code class="text-xs bg-black/10 dark:bg-white/10 px-2 py-1 rounded">{item.example}</code>
        </div>
      ))
    }
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">åˆªé™¤åæ‡‰</h2>
  <p class="text-[var(--text-secondary)] leading-relaxed mb-4">
    ä½¿ç”¨ kind 5ï¼ˆåˆªé™¤äº‹ä»¶ï¼‰ä¾†æ’¤å›åæ‡‰ï¼š
  </p>

  <div
    class="not-prose mb-6 p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto"
  >
    <pre
      class="text-[var(--text-secondary)]"><code>{`{
  "kind": 5,
  "content": "å–æ¶ˆåæ‡‰",
  "tags": [
    ["e", "<reaction-event-id>"]  // è¦åˆªé™¤çš„åæ‡‰äº‹ä»¶
  ]
}

// æ³¨æ„ï¼šä¸­ç¹¼å™¨å¯èƒ½ä¸æœƒç«‹å³åˆªé™¤
// å®¢æˆ¶ç«¯æ‡‰è©²æª¢æŸ¥ kind 5 äº‹ä»¶ä¾†éæ¿¾å·²åˆªé™¤çš„åæ‡‰`}</code></pre>
  </div>

  <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-8 mb-4">èˆ‡ Zaps çš„é—œä¿‚</h2>

  <div class="not-prose mb-8">
    <table class="w-full text-sm">
      <thead>
        <tr class="border-b border-[var(--border-default)]">
          <th class="text-left py-3 px-4 font-semibold text-[var(--text-primary)]" scope="col"
            >ç‰¹æ€§</th
          >
          <th class="text-left py-3 px-4 font-semibold text-[var(--text-primary)]" scope="col"
            >NIP-25 åæ‡‰</th
          >
          <th class="text-left py-3 px-4 font-semibold text-[var(--text-primary)]" scope="col"
            >NIP-57 Zaps</th
          >
        </tr>
      </thead>
      <tbody class="text-[var(--text-secondary)]">
        <tr class="border-b border-[var(--border-default)]">
          <td class="py-3 px-4">é¡å‹</td>
          <td class="py-3 px-4">ç¤¾äº¤äº’å‹•</td>
          <td class="py-3 px-4">é‡‘éŒ¢æ‰“è³</td>
        </tr>
        <tr class="border-b border-[var(--border-default)]">
          <td class="py-3 px-4">æˆæœ¬</td>
          <td class="py-3 px-4">å…è²»</td>
          <td class="py-3 px-4">æ¯”ç‰¹å¹£ï¼ˆè°ï¼‰</td>
        </tr>
        <tr class="border-b border-[var(--border-default)]">
          <td class="py-3 px-4">Kind</td>
          <td class="py-3 px-4">7</td>
          <td class="py-3 px-4">9735</td>
        </tr>
        <tr class="border-b border-[var(--border-default)]">
          <td class="py-3 px-4">ç”¨é€”</td>
          <td class="py-3 px-4">è¡¨é”æƒ…æ„Ÿ</td>
          <td class="py-3 px-4">ç¶“æ¿Ÿæ”¯æŒ</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="not-prose mb-8 p-4 rounded-lg bg-blue-500/10 border border-blue-500/30">
    <p class="text-sm text-blue-700 dark:text-blue-400">
      <strong>æç¤ºï¼š</strong>
      è¨±å¤šå®¢æˆ¶ç«¯å°‡ "+" åæ‡‰é¡¯ç¤ºç‚ºæ„›å¿ƒåœ–ç¤ºã€‚å¦‚æœä½ æƒ³æ”¯æŒæ›´å¤šè¡¨æƒ…åæ‡‰ï¼Œ ç¢ºä¿ä½ çš„ UI å¯ä»¥æ­£ç¢ºæ¸²æŸ“å„ç¨® Unicode
      è¡¨æƒ…ç¬¦è™Ÿã€‚
    </p>
  </div>
</ArticleLayout>
