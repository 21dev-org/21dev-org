---
import BookLayout from '@/layouts/BookLayout.astro';
import { getBookById } from '@/data/books';

const book = getBookById('blocksize-war')!;
---

<BookLayout book={book}>
  <div class="mb-8">
    <h2 class="text-xl font-semibold text-[var(--text-primary)] mb-4">關於本書</h2>
    <p class="text-[var(--text-secondary)] leading-relaxed mb-4">
      《區塊大小戰爭》詳細記錄了 2015 年至 2017 年間比特幣社群關於擴容方案的激烈爭論。
      這場「戰爭」最終導致了比特幣現金（BCH）的分叉，並深刻影響了比特幣的治理模式。
    </p>
    <p class="text-[var(--text-secondary)] leading-relaxed">
      作者 Jonathan Bier 以中立的角度，詳細描述了各方的立場、策略和行動，
      幫助讀者理解這段重要的比特幣歷史。
    </p>
  </div>

  <div class="mb-8">
    <h2 class="text-xl font-semibold text-[var(--text-primary)] mb-4">為什麼要讀這本書</h2>
    <ul class="space-y-3 text-[var(--text-secondary)]">
      <li class="flex items-start gap-3">
        <span class="text-bitcoin-500 mt-1">•</span>
        <span>理解比特幣的去中心化治理是如何運作的</span>
      </li>
      <li class="flex items-start gap-3">
        <span class="text-bitcoin-500 mt-1">•</span>
        <span>了解 SegWit 升級的背景和實現過程</span>
      </li>
      <li class="flex items-start gap-3">
        <span class="text-bitcoin-500 mt-1">•</span>
        <span>認識比特幣社群中的主要參與者和他們的角色</span>
      </li>
      <li class="flex items-start gap-3">
        <span class="text-bitcoin-500 mt-1">•</span>
        <span>學習協議升級的複雜性和風險</span>
      </li>
      <li class="flex items-start gap-3">
        <span class="text-bitcoin-500 mt-1">•</span>
        <span>理解為什麼「不改變」有時候是最好的選擇</span>
      </li>
    </ul>
  </div>

  <div class="mb-8">
    <h2 class="text-xl font-semibold text-[var(--text-primary)] mb-4">兩派觀點對比</h2>
    <div class="grid md:grid-cols-2 gap-4">
      <div class="p-4 rounded-lg border border-blue-500/30 bg-blue-500/5">
        <h3 class="font-semibold text-blue-600 dark:text-blue-400 mb-3 flex items-center gap-2">
          <span>🔷</span>
          小區塊派（Small Blockers）
        </h3>
        <ul class="space-y-2 text-sm text-[var(--text-secondary)]">
          <li class="flex items-start gap-2">
            <span class="text-blue-500">•</span>
            <span>優先保持去中心化和節點可運行性</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-blue-500">•</span>
            <span>支持 SegWit 作為軟分叉升級</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-blue-500">•</span>
            <span>Layer 2（閃電網路）解決擴容問題</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-blue-500">•</span>
            <span>代表：Bitcoin Core 開發者</span>
          </li>
        </ul>
      </div>
      <div class="p-4 rounded-lg border border-orange-500/30 bg-orange-500/5">
        <h3 class="font-semibold text-orange-600 dark:text-orange-400 mb-3 flex items-center gap-2">
          <span>🔶</span>
          大區塊派（Big Blockers）
        </h3>
        <ul class="space-y-2 text-sm text-[var(--text-secondary)]">
          <li class="flex items-start gap-2">
            <span class="text-orange-500">•</span>
            <span>優先增加鏈上交易容量</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-orange-500">•</span>
            <span>直接提高區塊大小上限</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-orange-500">•</span>
            <span>比特幣應作為「點對點電子現金」</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-orange-500">•</span>
            <span>代表：部分礦池和企業</span>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div class="mb-8">
    <h2 class="text-xl font-semibold text-[var(--text-primary)] mb-4">關鍵人物</h2>
    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
      {
        [
          {
            name: 'Gavin Andresen',
            role: '前首席維護者',
            stance: '大區塊派',
            desc: '早期支持 Bitcoin XT',
          },
          { name: 'Mike Hearn', role: '開發者', stance: '大區塊派', desc: 'Bitcoin XT 創建者' },
          { name: 'Roger Ver', role: '投資者', stance: '大區塊派', desc: 'Bitcoin Cash 支持者' },
          { name: 'Jihan Wu', role: '比特大陸 CEO', stance: '大區塊派', desc: '重要礦池運營者' },
          {
            name: 'Greg Maxwell',
            role: 'Core 開發者',
            stance: '小區塊派',
            desc: 'SegWit 主要設計者之一',
          },
          {
            name: 'Pieter Wuille',
            role: 'Core 開發者',
            stance: '小區塊派',
            desc: 'SegWit BIP 作者',
          },
        ].map((person) => (
          <div class="p-3 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)]">
            <h4 class="font-semibold text-[var(--text-primary)]">{person.name}</h4>
            <p class="text-xs text-[var(--text-tertiary)]">{person.role}</p>
            <p class="text-sm text-[var(--text-secondary)] mt-1">{person.desc}</p>
            <span
              class={`inline-block mt-2 px-2 py-0.5 text-xs rounded ${
                person.stance === '大區塊派'
                  ? 'bg-orange-500/10 text-orange-600 dark:text-orange-400'
                  : 'bg-blue-500/10 text-blue-600 dark:text-blue-400'
              }`}
            >
              {person.stance}
            </span>
          </div>
        ))
      }
    </div>
  </div>

  <div class="mb-8">
    <h2 class="text-xl font-semibold text-[var(--text-primary)] mb-4">重要事件時間線</h2>
    <div class="relative">
      <div class="absolute left-[39px] top-0 bottom-0 w-0.5 bg-[var(--border-default)]"></div>
      <div class="space-y-6">
        {
          [
            {
              year: '2015.6',
              event: 'Gavin Andresen 和 Mike Hearn 提出 Bitcoin XT',
              desc: '首次大區塊提案，目標 8MB',
            },
            {
              year: '2016.1',
              event: 'Bitcoin Classic 發布',
              desc: '提議 2MB 區塊，獲得部分礦工支持',
            },
            { year: '2016.2', event: '香港共識', desc: '開發者與礦工達成臨時協議，承諾硬分叉擴容' },
            {
              year: '2016.11',
              event: 'SegWit 在 Bitcoin Core 0.13.1 啟用',
              desc: '軟分叉升級方案發布',
            },
            { year: '2017.2', event: 'Bitcoin Unlimited 攻擊', desc: '軟體漏洞導致大量節點崩潰' },
            { year: '2017.5', event: '紐約協議（NYA）簽署', desc: '58 家公司同意 Segwit2x 方案' },
            { year: '2017.8.1', event: 'Bitcoin Cash 誕生', desc: '8MB 區塊的比特幣硬分叉' },
            { year: '2017.8.24', event: 'SegWit 正式啟用', desc: '在區塊 481,824 激活' },
            { year: '2017.11', event: 'Segwit2x 取消', desc: '缺乏共識，硬分叉計劃終止' },
          ].map((item) => (
            <div class="flex items-start gap-4 relative">
              <div class="flex-shrink-0 w-20 text-right">
                <span class="text-sm font-medium text-bitcoin-500">{item.year}</span>
              </div>
              <div class="flex-shrink-0 w-3 h-3 mt-1.5 rounded-full bg-bitcoin-500 border-2 border-[var(--bg-primary)] z-10" />
              <div class="flex-1 pb-2">
                <h4 class="font-medium text-[var(--text-primary)]">{item.event}</h4>
                <p class="text-sm text-[var(--text-secondary)]">{item.desc}</p>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </div>

  <div class="mb-8">
    <h2 class="text-xl font-semibold text-[var(--text-primary)] mb-4">核心爭議</h2>
    <div class="space-y-4">
      <div class="p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)]">
        <h3 class="font-semibold text-[var(--text-primary)] mb-2">去中心化 vs 擴容</h3>
        <p class="text-sm text-[var(--text-secondary)]">
          更大的區塊意味著更高的硬體需求，可能導致只有大型數據中心能運行全節點，
          威脅比特幣的去中心化本質。這是整場爭論的核心技術議題。
        </p>
      </div>
      <div class="p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)]">
        <h3 class="font-semibold text-[var(--text-primary)] mb-2">軟分叉 vs 硬分叉</h3>
        <p class="text-sm text-[var(--text-secondary)]">
          SegWit 選擇軟分叉是為了向後兼容，不強制所有用戶升級。
          硬分叉則需要所有參與者同時升級，風險更高但可以做更激進的改變。
        </p>
      </div>
      <div class="p-4 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)]">
        <h3 class="font-semibold text-[var(--text-primary)] mb-2">誰控制比特幣？</h3>
        <p class="text-sm text-[var(--text-secondary)]">
          這場戰爭揭示了比特幣治理的複雜性：開發者、礦工、交易所、用戶都有不同程度的影響力，
          但沒有任何一方能單獨決定比特幣的未來。
        </p>
      </div>
    </div>
  </div>

  <div class="mb-8">
    <h2 class="text-xl font-semibold text-[var(--text-primary)] mb-4">戰爭結果與遺產</h2>
    <div class="grid md:grid-cols-2 gap-4">
      <div class="p-4 rounded-lg border border-green-500/30 bg-green-500/5">
        <h3 class="font-semibold text-green-600 dark:text-green-400 mb-2">勝利的一方</h3>
        <ul class="space-y-1 text-sm text-[var(--text-secondary)]">
          <li>• SegWit 成功激活</li>
          <li>• 閃電網路成為主要擴容方案</li>
          <li>• 用戶主權得到證明（UASF）</li>
          <li>• 比特幣保持向後兼容</li>
        </ul>
      </div>
      <div class="p-4 rounded-lg border border-yellow-500/30 bg-yellow-500/5">
        <h3 class="font-semibold text-yellow-600 dark:text-yellow-400 mb-2">持久影響</h3>
        <ul class="space-y-1 text-sm text-[var(--text-secondary)]">
          <li>• Bitcoin Cash 作為替代方案存在</li>
          <li>• 社群對硬分叉更加謹慎</li>
          <li>• 「數位黃金」定位逐漸確立</li>
          <li>• 協議穩定性優先於快速變化</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="mb-8">
    <h2 class="text-xl font-semibold text-[var(--text-primary)] mb-4">適合讀者</h2>
    <p class="text-[var(--text-secondary)] leading-relaxed mb-4">
      這本書不需要深厚的技術背景，適合任何想了解比特幣歷史和治理的讀者。
      它以故事的方式呈現，即使是比特幣新手也能輕鬆閱讀。
    </p>
    <div class="grid sm:grid-cols-3 gap-3">
      <div class="flex items-center gap-2 p-3 rounded-lg bg-[var(--bg-secondary)]">
        <span class="text-green-500">✓</span>
        <span class="text-sm text-[var(--text-secondary)]">比特幣歷史愛好者</span>
      </div>
      <div class="flex items-center gap-2 p-3 rounded-lg bg-[var(--bg-secondary)]">
        <span class="text-green-500">✓</span>
        <span class="text-sm text-[var(--text-secondary)]">區塊鏈治理研究者</span>
      </div>
      <div class="flex items-center gap-2 p-3 rounded-lg bg-[var(--bg-secondary)]">
        <span class="text-green-500">✓</span>
        <span class="text-sm text-[var(--text-secondary)]">想理解社群動態的新手</span>
      </div>
    </div>
  </div>

  <div class="p-4 rounded-lg bg-bitcoin-500/10 border border-bitcoin-500/30">
    <h4 class="font-semibold text-bitcoin-700 dark:text-bitcoin-400 mb-2">延伸閱讀</h4>
    <p class="text-sm text-bitcoin-700/80 dark:text-bitcoin-400/80 mb-3">
      讀完這本書後，可以深入了解 SegWit 的技術細節， 理解這項升級為何對閃電網路至關重要。
    </p>
    <div class="flex flex-wrap gap-2">
      <a
        href="/bips/bip-0141"
        class="inline-flex items-center gap-1 text-sm text-bitcoin-600 dark:text-bitcoin-400 hover:underline"
      >
        了解 SegWit (BIP-141) →
      </a>
      <span class="text-bitcoin-500/50">|</span>
      <a
        href="/tech/lightning/"
        class="inline-flex items-center gap-1 text-sm text-bitcoin-600 dark:text-bitcoin-400 hover:underline"
      >
        探索閃電網路 →
      </a>
    </div>
  </div>
</BookLayout>
