---
import ArticleLayout from '@/layouts/ArticleLayout.astro';
---

<ArticleLayout
  title="地址類型詳解"
  description="了解比特幣不同地址類型：P2PKH、P2SH、P2WPKH、P2WSH、P2TR 的區別與演進。"
  breadcrumbs={[
    { label: '學習', href: '/learn/' },
    { label: '進階知識', href: '/learn/intermediate/' },
    { label: '地址類型詳解' },
  ]}
  difficulty="intermediate"
  readingTime="15 分鐘"
  prevPage={{ title: '返回進階知識', href: '/learn/intermediate/' }}
  nextPage={{ title: '下一篇：UTXO 模型', href: '/learn/intermediate/utxo-model' }}
>
  <p class="text-xl text-[var(--text-secondary)] mb-8">
    從 1 開頭到 bc1p 開頭，比特幣地址經歷了多次演進。了解每種地址類型的特點和用途。
  </p>

  <div class="prose prose-lg prose-zh dark:prose-invert max-w-none">
    <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-12 mb-4">地址類型一覽</h2>

    <div class="not-prose mb-8 overflow-x-auto">
      <table class="w-full text-sm" aria-label="比特幣地址類型一覽">
        <thead>
          <tr class="border-b border-[var(--border-default)]">
            <th scope="col" class="text-left py-3 px-2 text-[var(--text-primary)]">類型</th>
            <th scope="col" class="text-left py-3 px-2 text-[var(--text-primary)]">前綴</th>
            <th scope="col" class="text-left py-3 px-2 text-[var(--text-primary)]">年份</th>
            <th scope="col" class="text-left py-3 px-2 text-[var(--text-primary)]">BIP</th>
          </tr>
        </thead>
        <tbody class="text-[var(--text-secondary)]">
          <tr class="border-b border-[var(--border-default)]">
            <td class="py-3 px-2">P2PKH (Legacy)</td>
            <td class="py-3 px-2 font-mono">1...</td>
            <td class="py-3 px-2">2009</td>
            <td class="py-3 px-2">-</td>
          </tr>
          <tr class="border-b border-[var(--border-default)]">
            <td class="py-3 px-2">P2SH</td>
            <td class="py-3 px-2 font-mono">3...</td>
            <td class="py-3 px-2">2012</td>
            <td class="py-3 px-2">BIP-16</td>
          </tr>
          <tr class="border-b border-[var(--border-default)]">
            <td class="py-3 px-2">P2WPKH (Native SegWit)</td>
            <td class="py-3 px-2 font-mono">bc1q...</td>
            <td class="py-3 px-2">2017</td>
            <td class="py-3 px-2">BIP-141/173</td>
          </tr>
          <tr class="border-b border-[var(--border-default)]">
            <td class="py-3 px-2">P2WSH</td>
            <td class="py-3 px-2 font-mono">bc1q...（較長）</td>
            <td class="py-3 px-2">2017</td>
            <td class="py-3 px-2">BIP-141</td>
          </tr>
          <tr>
            <td class="py-3 px-2">P2TR (Taproot)</td>
            <td class="py-3 px-2 font-mono">bc1p...</td>
            <td class="py-3 px-2">2021</td>
            <td class="py-3 px-2">BIP-341/350</td>
          </tr>
        </tbody>
      </table>
    </div>

    <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-12 mb-4">P2PKH — Legacy 地址</h2>
    <div class="not-prose mb-4 p-3 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto">
      <p class="text-[var(--text-secondary)]">1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2</p>
    </div>
    <p class="text-[var(--text-secondary)] leading-relaxed mb-6">
      Pay to Public Key Hash 是比特幣最早的標準地址格式。地址是公鑰哈希的 Base58Check 編碼。
    </p>
    <ul class="space-y-2 text-[var(--text-secondary)] mb-6">
      <li>• 前綴：<code class="px-1 bg-neutral-100 dark:bg-neutral-800 rounded">1</code>（主網）</li>
      <li>• 編碼：Base58Check</li>
      <li>• 特點：最廣泛支援，但交易費用較高</li>
      <li>• 腳本：<code class="px-1 bg-neutral-100 dark:bg-neutral-800 rounded text-xs">OP_DUP OP_HASH160 &lt;pubKeyHash&gt; OP_EQUALVERIFY OP_CHECKSIG</code></li>
    </ul>

    <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-12 mb-4">P2SH — 腳本哈希</h2>
    <div class="not-prose mb-4 p-3 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto">
      <p class="text-[var(--text-secondary)]">3J98t1WpEZ73CNmQviecrnyiWrnqRhWNLy</p>
    </div>
    <p class="text-[var(--text-secondary)] leading-relaxed mb-6">
      Pay to Script Hash 允許將複雜腳本壓縮為 20 字節哈希。發送者只需知道哈希，不需要了解完整腳本。
    </p>
    <ul class="space-y-2 text-[var(--text-secondary)] mb-6">
      <li>• 前綴：<code class="px-1 bg-neutral-100 dark:bg-neutral-800 rounded">3</code>（主網）</li>
      <li>• 用途：多簽、嵌套 SegWit (P2SH-P2WPKH)</li>
      <li>• 優點：隱藏複雜腳本，發送者體驗一致</li>
      <li>• 參考：<a href="/bips/bip-0016" class="text-bitcoin-500 hover:underline">BIP-16</a></li>
    </ul>

    <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-12 mb-4">P2WPKH — Native SegWit</h2>
    <div class="not-prose mb-4 p-3 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto">
      <p class="text-[var(--text-secondary)]">bc1qar0srrr7xfkvy5l643lydnw9re59gtzzwf5mdq</p>
    </div>
    <p class="text-[var(--text-secondary)] leading-relaxed mb-6">
      SegWit 版本 0 的原生單簽地址。使用 Bech32 編碼，以 bc1q 開頭。
    </p>
    <ul class="space-y-2 text-[var(--text-secondary)] mb-6">
      <li>• 前綴：<code class="px-1 bg-neutral-100 dark:bg-neutral-800 rounded">bc1q</code>（主網）</li>
      <li>• 編碼：Bech32</li>
      <li>• 優點：
        <ul class="ml-4 mt-2 space-y-1">
          <li>- 交易費用比 P2PKH 低約 38%</li>
          <li>- 地址全小寫，不易出錯</li>
          <li>- 更好的錯誤檢測能力</li>
        </ul>
      </li>
      <li>• 參考：<a href="/bips/bip-0141" class="text-bitcoin-500 hover:underline">BIP-141</a>、<a href="/bips/bip-0173" class="text-bitcoin-500 hover:underline">BIP-173</a></li>
    </ul>

    <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-12 mb-4">P2WSH — SegWit 腳本哈希</h2>
    <div class="not-prose mb-4 p-3 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto">
      <p class="text-[var(--text-secondary)]">bc1qrp33g0q5c5txsp9arysrx4k6zdkfs4nce4xj0gdcccefvpysxf3qccfmv3</p>
    </div>
    <p class="text-[var(--text-secondary)] leading-relaxed mb-6">
      SegWit 版本 0 的腳本哈希地址，用於多簽和複雜腳本。使用 32 字節哈希（比 P2SH 的 20 字節更安全）。
    </p>
    <ul class="space-y-2 text-[var(--text-secondary)] mb-6">
      <li>• 前綴：<code class="px-1 bg-neutral-100 dark:bg-neutral-800 rounded">bc1q</code>（較長，62 字符）</li>
      <li>• 用途：Native SegWit 多簽、HTLC</li>
      <li>• 安全性：使用 SHA256（32 字節）而非 HASH160（20 字節）</li>
    </ul>

    <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-12 mb-4">P2TR — Taproot</h2>
    <div class="not-prose mb-4 p-3 rounded-lg bg-[var(--bg-secondary)] border border-[var(--border-default)] font-mono text-sm overflow-x-auto">
      <p class="text-[var(--text-secondary)]">bc1p5d7rjq7g6rdk2yhzks9smlaqtedr4dekq08ge8ztwac72sfr9rusxg3297</p>
    </div>
    <p class="text-[var(--text-secondary)] leading-relaxed mb-6">
      SegWit 版本 1，使用 Schnorr 簽章和 MAST（Merkelized Alternative Script Trees）。
      這是目前最先進的地址類型。
    </p>
    <ul class="space-y-2 text-[var(--text-secondary)] mb-6">
      <li>• 前綴：<code class="px-1 bg-neutral-100 dark:bg-neutral-800 rounded">bc1p</code>（主網）</li>
      <li>• 編碼：Bech32m</li>
      <li>• 優點：
        <ul class="ml-4 mt-2 space-y-1">
          <li>- 更好的隱私性（多簽看起來像單簽）</li>
          <li>- 更低的複雜腳本費用</li>
          <li>- 支援更先進的智能合約</li>
          <li>- 批量驗證更高效</li>
        </ul>
      </li>
      <li>• 參考：<a href="/bips/bip-0340" class="text-bitcoin-500 hover:underline">BIP-340</a>、<a href="/bips/bip-0341" class="text-bitcoin-500 hover:underline">BIP-341</a></li>
    </ul>

    <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-12 mb-4">該使用哪種地址？</h2>

    <div class="not-prose mb-8 p-4 rounded-lg bg-bitcoin-500/10 border border-bitcoin-500/30">
      <p class="text-sm text-bitcoin-700 dark:text-bitcoin-400">
        <strong>推薦：</strong> 新用戶應優先使用 <strong>bc1q</strong>（P2WPKH）或 <strong>bc1p</strong>（P2TR）地址。
        這些地址費用最低，且被大多數現代錢包和交易所支援。
      </p>
    </div>

    <ul class="space-y-3 text-[var(--text-secondary)] mb-6">
      <li class="flex items-start gap-2">
        <span class="text-green-500">✓</span>
        <span><strong class="text-[var(--text-primary)]">日常使用</strong>：P2WPKH (bc1q) 或 P2TR (bc1p)</span>
      </li>
      <li class="flex items-start gap-2">
        <span class="text-green-500">✓</span>
        <span><strong class="text-[var(--text-primary)]">多簽錢包</strong>：P2WSH 或 P2TR</span>
      </li>
      <li class="flex items-start gap-2">
        <span class="text-yellow-500">△</span>
        <span><strong class="text-[var(--text-primary)]">最大相容性</strong>：P2SH-P2WPKH (3 開頭)</span>
      </li>
      <li class="flex items-start gap-2">
        <span class="text-red-500">✗</span>
        <span><strong class="text-[var(--text-primary)]">避免使用</strong>：P2PKH (1 開頭) 除非必要</span>
      </li>
    </ul>

    <h2 class="text-2xl font-bold text-[var(--text-primary)] mt-12 mb-4">費用比較</h2>
    <p class="text-[var(--text-secondary)] leading-relaxed mb-4">
      以典型的 1-input-2-output 交易為例：
    </p>
    <div class="not-prose mb-6 overflow-x-auto">
      <table class="w-full text-sm" aria-label="不同地址類型的交易費用比較">
        <thead>
          <tr class="border-b border-[var(--border-default)]">
            <th scope="col" class="text-left py-3 px-2 text-[var(--text-primary)]">地址類型</th>
            <th scope="col" class="text-left py-3 px-2 text-[var(--text-primary)]">交易大小</th>
            <th scope="col" class="text-left py-3 px-2 text-[var(--text-primary)]">相對費用</th>
          </tr>
        </thead>
        <tbody class="text-[var(--text-secondary)]">
          <tr class="border-b border-[var(--border-default)]">
            <td class="py-3 px-2">P2PKH</td>
            <td class="py-3 px-2">~226 vbytes</td>
            <td class="py-3 px-2">100%</td>
          </tr>
          <tr class="border-b border-[var(--border-default)]">
            <td class="py-3 px-2">P2SH-P2WPKH</td>
            <td class="py-3 px-2">~167 vbytes</td>
            <td class="py-3 px-2">~74%</td>
          </tr>
          <tr class="border-b border-[var(--border-default)]">
            <td class="py-3 px-2">P2WPKH</td>
            <td class="py-3 px-2">~141 vbytes</td>
            <td class="py-3 px-2">~62%</td>
          </tr>
          <tr>
            <td class="py-3 px-2">P2TR</td>
            <td class="py-3 px-2">~154 vbytes</td>
            <td class="py-3 px-2">~68%</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</ArticleLayout>
